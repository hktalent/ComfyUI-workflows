{"last_node_id":118,"last_link_id":207,"nodes":[{"id":4,"type":"CheckpointLoaderSimple","pos":[-185,-111],"size":{"0":315,"1":98},"flags":{},"order":0,"mode":0,"outputs":[{"name":"MODEL","type":"MODEL","links":[63],"slot_index":0,"label":"模型"},{"name":"CLIP","type":"CLIP","links":[19,22],"slot_index":1,"label":"CLIP"},{"name":"VAE","type":"VAE","links":[94],"slot_index":2,"label":"VAE"}],"properties":{"Node name for S&R":"CheckpointLoaderSimple"},"widgets_values":["stablesr_768v_000139.ckpt"]},{"id":31,"type":"ApplyStableSRUpscaler","pos":[-183,44],"size":{"0":315,"1":102},"flags":{},"order":8,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":63,"label":"model"},{"name":"latent_image","type":"LATENT","link":null,"label":"latent_image"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[133],"shape":3,"slot_index":0,"label":"MODEL"}],"properties":{"Node name for S&R":"ApplyStableSRUpscaler"},"widgets_values":["webui_768v_139.ckpt"]},{"id":74,"type":"FreeU_V2","pos":[-184,195],"size":{"0":315,"1":130},"flags":{},"order":14,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":133,"label":"model"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[134],"shape":3,"slot_index":0,"label":"MODEL"}],"properties":{"Node name for S&R":"FreeU_V2"},"widgets_values":[1.3,1.4,0.9,0.2]},{"id":29,"type":"ImageScaleBy","pos":[-187,384],"size":{"0":315,"1":82},"flags":{},"order":13,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":194,"label":"图像"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[87,123],"shape":3,"slot_index":0,"label":"图像"}],"properties":{"Node name for S&R":"ImageScaleBy"},"widgets_values":["lanczos",2]},{"id":14,"type":"CLIPTextEncode","pos":[156,-109],"size":{"0":400,"1":200},"flags":{},"order":9,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":19,"label":"CLIP"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[93],"shape":3,"slot_index":0,"label":"条件"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["(masterpiece), (best quality), (realistic),(very clear)"]},{"id":15,"type":"CLIPTextEncode","pos":[159,148],"size":{"0":400,"1":200},"flags":{},"order":10,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":22,"label":"CLIP"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[92],"shape":3,"slot_index":0,"label":"条件"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["3d, cartoon, anime, sketches, (worst quality), (low quality)"]},{"id":39,"type":"UltimateSDUpscaleNoUpscale","pos":[592,-107],"size":{"0":308.0407409667969,"1":555.9761962890625},"flags":{},"order":16,"mode":0,"inputs":[{"name":"upscaled_image","type":"IMAGE","link":87,"label":"upscaled_image"},{"name":"model","type":"MODEL","link":134,"label":"model"},{"name":"positive","type":"CONDITIONING","link":93,"label":"positive"},{"name":"negative","type":"CONDITIONING","link":92,"label":"negative"},{"name":"vae","type":"VAE","link":94,"label":"vae"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[88,120],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"UltimateSDUpscaleNoUpscale"},"widgets_values":[0,"fixed",20,7,"euler_ancestral","karras",1,"Linear",704,704,32,32,"None",1,64,8,16,"enable"]},{"id":67,"type":"ImageScale","pos":[933,13],"size":{"0":315,"1":130},"flags":{},"order":18,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":123,"label":"图像"},{"name":"width","type":"INT","link":121,"widget":{"name":"width"}},{"name":"height","type":"INT","link":122,"widget":{"name":"height"}}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[124],"shape":3,"slot_index":0,"label":"图像"}],"properties":{"Node name for S&R":"ImageScale"},"widgets_values":["nearest-exact",512,512,"disabled"]},{"id":68,"type":"GetImageSize","pos":[933,-102],"size":{"0":210,"1":46},"flags":{},"order":17,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":120,"label":"图像"}],"outputs":[{"name":"width","type":"INT","links":[121],"shape":3,"slot_index":0,"label":"宽度"},{"name":"height","type":"INT","links":[122],"shape":3,"slot_index":1,"label":"高度"}],"properties":{"Node name for S&R":"GetImageSize"}},{"id":34,"type":"StableSRColorFix","pos":[939,205],"size":{"0":315,"1":78},"flags":{},"order":19,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":88,"label":"image"},{"name":"color_map_image","type":"IMAGE","link":124,"label":"color_map_image"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[158,160,161,168,197],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"StableSRColorFix"},"widgets_values":["Wavelet"]},{"id":81,"type":"ControlNetApply","pos":[2130,-10],"size":{"0":317.4000244140625,"1":98},"flags":{},"order":26,"mode":0,"inputs":[{"name":"conditioning","type":"CONDITIONING","link":145,"label":"条件"},{"name":"control_net","type":"CONTROL_NET","link":146,"label":"ControlNet"},{"name":"image","type":"IMAGE","link":161,"label":"图像"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[137],"shape":3,"slot_index":0,"label":"条件"}],"properties":{"Node name for S&R":"ControlNetApply"},"widgets_values":[0.9]},{"id":78,"type":"UpscaleModelLoader","pos":[2130,140],"size":{"0":315,"1":58},"flags":{},"order":1,"mode":0,"outputs":[{"name":"UPSCALE_MODEL","type":"UPSCALE_MODEL","links":[140],"shape":3,"label":"放大模型"}],"properties":{"Node name for S&R":"UpscaleModelLoader"},"widgets_values":["4x_NMKD-Superscale-SP_178000_G.pth"]},{"id":83,"type":"IPAdapterModelLoader","pos":[2470,-130],"size":{"0":315,"1":58},"flags":{},"order":2,"mode":0,"outputs":[{"name":"IPADAPTER","type":"IPADAPTER","links":[148],"shape":3,"label":"IPADAPTER"}],"properties":{"Node name for S&R":"IPAdapterModelLoader"},"widgets_values":["ip-adapter-plus_sd15.bin"]},{"id":89,"type":"Reroute","pos":[1370,310],"size":[75,26],"flags":{},"order":12,"mode":0,"inputs":[{"name":"","type":"*","link":157}],"outputs":[{"name":"CLIP","type":"CLIP","links":[153,202]}],"properties":{"showOutputText":true,"horizontal":false}},{"id":116,"type":"CLIPTextEncode","pos":[1720,-130],"size":{"0":369.3165283203125,"1":76.00001525878906},"flags":{},"order":15,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":202,"label":"CLIP"}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[203],"shape":3,"label":"条件","slot_index":0}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":[""]},{"id":80,"type":"ControlNetLoader","pos":[2130,-120],"size":{"0":315,"1":58},"flags":{},"order":3,"mode":0,"outputs":[{"name":"CONTROL_NET","type":"CONTROL_NET","links":[146],"shape":3,"slot_index":0,"label":"ControlNet"}],"properties":{"Node name for S&R":"ControlNetLoader"},"widgets_values":["control_v11f1e_sd15_tile.pth"]},{"id":84,"type":"CLIPVisionLoader","pos":[2475,-22],"size":{"0":315,"1":58},"flags":{},"order":4,"mode":0,"outputs":[{"name":"CLIP_VISION","type":"CLIP_VISION","links":[149],"shape":3,"label":"CLIP视觉"}],"properties":{"Node name for S&R":"CLIPVisionLoader"},"widgets_values":["SD1.5\\pytorch_model.bin"]},{"id":85,"type":"PrepImageForClipVision","pos":[2482,88],"size":{"0":315,"1":106},"flags":{},"order":20,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":158,"label":"image"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[150],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"PrepImageForClipVision"},"widgets_values":["LANCZOS","top",0]},{"id":82,"type":"IPAdapterApply","pos":[2489,237],"size":{"0":315,"1":278},"flags":{},"order":23,"mode":0,"inputs":[{"name":"ipadapter","type":"IPADAPTER","link":148,"slot_index":0,"label":"ipadapter"},{"name":"clip_vision","type":"CLIP_VISION","link":149,"slot_index":1,"label":"clip_vision"},{"name":"image","type":"IMAGE","link":150,"label":"image"},{"name":"model","type":"MODEL","link":205,"label":"model"},{"name":"attn_mask","type":"MASK","link":null,"label":"attn_mask"},{"name":"insightface","type":"INSIGHTFACE","link":null,"label":"insightface"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[206],"shape":3,"slot_index":0,"label":"MODEL"}],"properties":{"Node name for S&R":"IPAdapterApply"},"widgets_values":[0.6,1,"original",0,1,false]},{"id":75,"type":"UltimateSDUpscale","pos":[2830,-137],"size":{"0":315,"1":614},"flags":{},"order":27,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":160,"label":"image","slot_index":0},{"name":"model","type":"MODEL","link":206,"label":"model"},{"name":"positive","type":"CONDITIONING","link":137,"slot_index":2,"label":"positive"},{"name":"negative","type":"CONDITIONING","link":203,"slot_index":3,"label":"negative"},{"name":"vae","type":"VAE","link":139,"label":"vae"},{"name":"upscale_model","type":"UPSCALE_MODEL","link":140,"slot_index":5,"label":"upscale_model"},{"name":"upscale_by","type":"FLOAT","link":141,"widget":{"name":"upscale_by"},"slot_index":6,"label":"upscale_by"}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[162,207],"shape":3,"slot_index":0,"label":"IMAGE"}],"properties":{"Node name for S&R":"UltimateSDUpscale"},"widgets_values":[3,395053709500030,"randomize",8,1,"lcm","karras",0.4,"Linear",768,768,8,32,"None",1,64,8,16,"enable"]},{"id":112,"type":"Gemini_API_S_Zho","pos":[1730,0],"size":{"0":355.0140380859375,"1":207.28726196289062},"flags":{},"order":22,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":197,"slot_index":0,"label":"image"}],"outputs":[{"name":"text","type":"STRING","links":[195],"shape":3,"slot_index":0,"label":"text"}],"properties":{"Node name for S&R":"Gemini_API_S_Zho"},"widgets_values":["text = ' ' # @param {type:\"string\"}\n\nprompt = \"You are creating a prompt for Stable Diffusion to generate an image. First step: describe this image, then put description into text. Second step: generate a text prompt for %s based on first step.  Only respond with the prompt itself, but embellish it as needed but keep it under 80 tokens. \" % text","gemini-pro-vision",false],"color":"#222"},{"id":90,"type":"Float","pos":[1380,-120],"size":{"0":315,"1":58},"flags":{},"order":5,"mode":0,"outputs":[{"name":"FLOAT","type":"FLOAT","links":[141],"shape":3,"label":"浮点","slot_index":0}],"properties":{"Node name for S&R":"Float"},"widgets_values":[4],"color":"#432","bgcolor":"#653"},{"id":92,"type":"Image Comparer (rgthree)","pos":{"0":1374,"1":-834,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"size":{"0":653.4579467773438,"1":432.60040283203125},"flags":{},"order":28,"mode":0,"inputs":[{"name":"image_a","type":"IMAGE","link":163,"dir":3,"label":"image_a"},{"name":"image_b","type":"IMAGE","link":162,"dir":3,"label":"image_b"}],"outputs":[],"properties":{"comparer_mode":"Slide"},"widgets_values":[["/view?filename=rgthree.compare._temp_ppupg_00019_.png&type=temp&subfolder=&rand=0.6322394240630256","/view?filename=rgthree.compare._temp_ppupg_00020_.png&type=temp&subfolder=&rand=0.3249798487040241"]]},{"id":76,"type":"CheckpointLoaderSimple","pos":[1370,-10],"size":{"0":315,"1":98},"flags":{},"order":6,"mode":0,"outputs":[{"name":"MODEL","type":"MODEL","links":[143],"shape":3,"slot_index":0,"label":"模型"},{"name":"CLIP","type":"CLIP","links":[144,157],"shape":3,"slot_index":1,"label":"CLIP"},{"name":"VAE","type":"VAE","links":[139],"shape":3,"slot_index":2,"label":"VAE"}],"properties":{"Node name for S&R":"CheckpointLoaderSimple"},"widgets_values":["realisticVisionV51_v51VAE.safetensors"]},{"id":86,"type":"CLIPTextEncode","pos":[1477,328],"size":{"0":217.8780975341797,"1":56.58431625366211},"flags":{},"order":25,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":153,"label":"CLIP"},{"name":"text","type":"STRING","link":198,"widget":{"name":"text"}}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[145],"shape":3,"slot_index":0,"label":"条件"}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["high detail, best quality"],"color":"#222"},{"id":79,"type":"LoraLoader","pos":[1376,146],"size":{"0":314.7889709472656,"1":126},"flags":{},"order":11,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":143,"slot_index":0,"label":"模型"},{"name":"clip","type":"CLIP","link":144,"label":"CLIP"}],"outputs":[{"name":"MODEL","type":"MODEL","links":[205],"shape":3,"slot_index":0,"label":"模型"},{"name":"CLIP","type":"CLIP","links":null,"shape":3,"label":"CLIP"}],"properties":{"Node name for S&R":"LoraLoader"},"widgets_values":["lcm-lora-sdv1-5.safetensors",1,1]},{"id":113,"type":"DisplayText_Zho","pos":[1730,260],"size":{"0":358.02166748046875,"1":114.77532196044922},"flags":{},"order":24,"mode":0,"inputs":[{"name":"text","type":"STRING","link":195,"widget":{"name":"text"},"label":"text"}],"outputs":[{"name":"text","type":"STRING","links":[198],"shape":3,"slot_index":0,"label":"text"}],"properties":{"Node name for S&R":"DisplayText_Zho"},"widgets_values":["","A painting of two men of similar age, one white and one Asian, standing closely together against a background of a city. The white man is on the left, wearing a gray suit with a red flag pin on the lapel. The Asian man is on the right, wearing a blue tunic. Both men have their left hands raised, holding a book. The white man's right hand is holding the Asian man's left arm. Slogan in Russian: \"In the name of peace and happiness, we will strengthen our friendship!\" Slogan in Chinese: \"We will strengthen our friendship and strive for peace and happiness!\""],"color":"#222"},{"id":117,"type":"SaveImage","pos":[738,-799],"size":{"0":550.2034301757812,"1":393.2756042480469},"flags":{},"order":29,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":207,"label":"图像"}],"properties":{},"widgets_values":["ComfyUI"]},{"id":95,"type":"SaveImage","pos":[78,-785],"size":{"0":537.0595703125,"1":385.6903076171875},"flags":{},"order":21,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":168,"label":"图像"}],"properties":{},"widgets_values":["ComfyUI"]},{"id":12,"type":"LoadImage","pos":[-864,-98],"size":{"0":573.42333984375,"1":445.68377685546875},"flags":{},"order":7,"mode":0,"outputs":[{"name":"IMAGE","type":"IMAGE","links":[163,194],"shape":3,"slot_index":0,"label":"图像"},{"name":"MASK","type":"MASK","links":null,"shape":3,"label":"遮罩"}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["OIP (13) (5).jpg","image"],"color":"#432","bgcolor":"#653"}],"links":[[19,4,1,14,0,"CLIP"],[22,4,1,15,0,"CLIP"],[63,4,0,31,0,"MODEL"],[87,29,0,39,0,"IMAGE"],[88,39,0,34,0,"IMAGE"],[92,15,0,39,3,"CONDITIONING"],[93,14,0,39,2,"CONDITIONING"],[94,4,2,39,4,"VAE"],[120,39,0,68,0,"IMAGE"],[121,68,0,67,1,"INT"],[122,68,1,67,2,"INT"],[123,29,0,67,0,"IMAGE"],[124,67,0,34,1,"IMAGE"],[133,31,0,74,0,"MODEL"],[134,74,0,39,1,"MODEL"],[137,81,0,75,2,"CONDITIONING"],[139,76,2,75,4,"VAE"],[140,78,0,75,5,"UPSCALE_MODEL"],[141,90,0,75,6,"FLOAT"],[143,76,0,79,0,"MODEL"],[144,76,1,79,1,"CLIP"],[145,86,0,81,0,"CONDITIONING"],[146,80,0,81,1,"CONTROL_NET"],[148,83,0,82,0,"IPADAPTER"],[149,84,0,82,1,"CLIP_VISION"],[150,85,0,82,2,"IMAGE"],[153,89,0,86,0,"CLIP"],[157,76,1,89,0,"*"],[158,34,0,85,0,"IMAGE"],[160,34,0,75,0,"IMAGE"],[161,34,0,81,2,"IMAGE"],[162,75,0,92,1,"IMAGE"],[163,12,0,92,0,"IMAGE"],[168,34,0,95,0,"IMAGE"],[194,12,0,29,0,"IMAGE"],[195,112,0,113,0,"STRING"],[197,34,0,112,0,"IMAGE"],[198,113,0,86,1,"STRING"],[202,89,0,116,0,"CLIP"],[203,116,0,75,3,"CONDITIONING"],[205,79,0,82,3,"MODEL"],[206,82,0,75,1,"MODEL"],[207,75,0,117,0,"IMAGE"]],"groups":[{"title":"Input","bounding":[-893,-233,647,685],"color":"#3f789e","font_size":24,"locked":false},{"title":"Fix","bounding":[-201,-233,1483,756],"color":"#3f789e","font_size":24,"locked":false},{"title":"Upscale","bounding":[1320,-235,1884,761],"color":"#3f789e","font_size":24,"locked":false}],"config":{},"extra":{"groupNodes":{}},"version":0.4}