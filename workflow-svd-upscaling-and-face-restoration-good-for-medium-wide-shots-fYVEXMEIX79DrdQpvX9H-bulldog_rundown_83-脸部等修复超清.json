{"last_node_id":361,"last_link_id":587,"nodes":[{"id":87,"type":"ImpactSimpleDetectorSEGS_for_AD","pos":[2100,25],"size":{"0":400,"1":286},"flags":{"collapsed":false},"order":60,"mode":0,"inputs":[{"name":"bbox_detector","type":"BBOX_DETECTOR","link":null,"slot_index":0},{"name":"image_frames","type":"IMAGE","link":132},{"name":"sam_model_opt","type":"SAM_MODEL","link":null,"slot_index":2},{"name":"segm_detector_opt","type":"SEGM_DETECTOR","link":null}],"outputs":[{"name":"SEGS","type":"SEGS","links":[123],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"ImpactSimpleDetectorSEGS_for_AD"},"widgets_values":[0.5,10,2.5,50,0.5,10,0,0.7],"color":"#223","bgcolor":"#335"},{"id":311,"type":"ImpactSimpleDetectorSEGS_for_AD","pos":[1100,25],"size":{"0":400,"1":286},"flags":{"collapsed":false},"order":50,"mode":0,"inputs":[{"name":"bbox_detector","type":"BBOX_DETECTOR","link":null,"slot_index":0},{"name":"image_frames","type":"IMAGE","link":502},{"name":"sam_model_opt","type":"SAM_MODEL","link":null,"slot_index":2},{"name":"segm_detector_opt","type":"SEGM_DETECTOR","link":null}],"outputs":[{"name":"SEGS","type":"SEGS","links":[497],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"ImpactSimpleDetectorSEGS_for_AD"},"widgets_values":[0.5,10,2.5,50,0.5,10,0,0.7],"color":"#223","bgcolor":"#335"},{"id":139,"type":"CLIPLoader","pos":[-800,25],"size":{"0":400,"1":58},"flags":{},"order":0,"mode":0,"outputs":[{"name":"CLIP","type":"CLIP","links":[204,212],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"CLIPLoader"},"widgets_values":["open_clip_pytorch_model.bin"],"color":"#232","bgcolor":"#353"},{"id":83,"type":"Anything Everywhere","pos":[-1300,1325],"size":{"0":400,"1":26},"flags":{},"order":27,"mode":0,"inputs":[{"name":"VAE","type":"*","link":118,"color_on":"#FF6E6E"}],"properties":{"Node name for S&R":"Anything Everywhere","group_restricted":false,"color_restricted":false}},{"id":323,"type":"UltralyticsDetectorProvider","pos":[-1300,1375],"size":{"0":400,"1":78},"flags":{},"order":1,"mode":0,"outputs":[{"name":"BBOX_DETECTOR","type":"BBOX_DETECTOR","links":[534],"shape":3,"slot_index":0},{"name":"SEGM_DETECTOR","type":"SEGM_DETECTOR","links":null,"shape":3}],"properties":{"Node name for S&R":"UltralyticsDetectorProvider"},"widgets_values":["bbox/face_yolov8m.pt"]},{"id":321,"type":"Anything Everywhere","pos":[-1300,1475],"size":{"0":400,"1":26},"flags":{},"order":24,"mode":0,"inputs":[{"name":"BBOX_DETECTOR","type":"*","link":534,"color_on":""}],"properties":{"Node name for S&R":"Anything Everywhere","group_restricted":false,"color_restricted":false}},{"id":325,"type":"SAMLoader","pos":[-1300,1525],"size":{"0":400,"1":82},"flags":{},"order":2,"mode":0,"outputs":[{"name":"SAM_MODEL","type":"SAM_MODEL","links":[533],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"SAMLoader"},"widgets_values":["sam_vit_b_01ec64.pth","AUTO"]},{"id":320,"type":"Anything Everywhere","pos":[-1300,1625],"size":{"0":400,"1":26},"flags":{},"order":25,"mode":0,"inputs":[{"name":"SAM_MODEL","type":"*","link":533,"color_on":""}],"properties":{"Node name for S&R":"Anything Everywhere","group_restricted":false,"color_restricted":false}},{"id":333,"type":"FaceRestoreModelLoader","pos":[1100,-375],"size":{"0":400,"1":58},"flags":{},"order":3,"mode":0,"outputs":[{"name":"FACERESTORE_MODEL","type":"FACERESTORE_MODEL","links":null,"shape":3}],"properties":{"Node name for S&R":"FaceRestoreModelLoader"},"widgets_values":["GFPGANv1.4.pth"]},{"id":310,"type":"SEGSDetailerForAnimateDiff","pos":[1100,325],"size":{"0":400,"1":375},"flags":{},"order":51,"mode":0,"inputs":[{"name":"image_frames","type":"IMAGE","link":509,"slot_index":0},{"name":"segs","type":"SEGS","link":497},{"name":"basic_pipe","type":"BASIC_PIPE","link":501,"slot_index":2},{"name":"refiner_basic_pipe_opt","type":"BASIC_PIPE","link":null}],"outputs":[{"name":"segs","type":"SEGS","links":[500],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"SEGSDetailerForAnimateDiff"},"widgets_values":[256,true,512,0,"fixed",10,7,"dpmpp_2m","karras",0.39999999999999997,0.2],"color":"#223","bgcolor":"#335"},{"id":334,"type":"VideoLinearCFGGuidance","pos":[-1300,150],"size":{"0":400,"1":58},"flags":{},"order":26,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":538}],"outputs":[{"name":"MODEL","type":"MODEL","links":[539],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"VideoLinearCFGGuidance"},"widgets_values":[1],"color":"#2a363b","bgcolor":"#3f5159"},{"id":47,"type":"ImageOnlyCheckpointLoader","pos":[-1300,25],"size":{"0":400,"1":100},"flags":{},"order":4,"mode":0,"outputs":[{"name":"MODEL","type":"MODEL","links":[538],"shape":3,"slot_index":0},{"name":"CLIP_VISION","type":"CLIP_VISION","links":[69],"shape":3,"slot_index":1},{"name":"VAE","type":"VAE","links":[68,71],"shape":3,"slot_index":2}],"properties":{"Node name for S&R":"ImageOnlyCheckpointLoader"},"widgets_values":["svd_xt-fp16.safetensors"],"color":"#2a363b","bgcolor":"#3f5159"},{"id":43,"type":"KSampler","pos":[600,25],"size":{"0":400,"1":275},"flags":{},"order":47,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":539},{"name":"positive","type":"CONDITIONING","link":211},{"name":"negative","type":"CONDITIONING","link":207},{"name":"latent_image","type":"LATENT","link":66}],"outputs":[{"name":"LATENT","type":"LATENT","links":[67],"slot_index":0}],"properties":{"Node name for S&R":"KSampler"},"widgets_values":[2645,"fixed",25,2.5,"euler","karras",1],"color":"#2a363b","bgcolor":"#3f5159"},{"id":86,"type":"SEGSDetailerForAnimateDiff","pos":[2100,325],"size":{"0":400,"1":375},"flags":{},"order":61,"mode":0,"inputs":[{"name":"image_frames","type":"IMAGE","link":138,"slot_index":0},{"name":"segs","type":"SEGS","link":123},{"name":"basic_pipe","type":"BASIC_PIPE","link":168,"slot_index":2},{"name":"refiner_basic_pipe_opt","type":"BASIC_PIPE","link":null}],"outputs":[{"name":"segs","type":"SEGS","links":[131],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"SEGSDetailerForAnimateDiff"},"widgets_values":[768,true,1152,0,"fixed",10,7,"dpmpp_2m","karras",0.3499999999999999,0.2],"color":"#223","bgcolor":"#335"},{"id":140,"type":"CLIPTextEncode","pos":[-800,275],"size":{"0":400,"1":76},"flags":{},"order":23,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":212}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[206],"shape":3,"slot_index":0}],"title":"Negative Prompt (SVD)","properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":[""],"color":"#232","bgcolor":"#353"},{"id":136,"type":"CLIPTextEncode","pos":[-800,100],"size":{"0":400,"1":76},"flags":{"collapsed":false},"order":22,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":204}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[209],"shape":3,"slot_index":0}],"title":"Positive Prompt (SVD)","properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["(rotating:2), (rotate:1.5),"],"color":"#232","bgcolor":"#353"},{"id":335,"type":"PreviewImage","pos":[-25,1100],"size":{"0":625,"1":325},"flags":{},"order":36,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":563}],"properties":{"Node name for S&R":"PreviewImage"}},{"id":65,"type":"UpscaleModelLoader","pos":[1600,25],"size":{"0":400,"1":58},"flags":{},"order":5,"mode":4,"outputs":[{"name":"UPSCALE_MODEL","type":"UPSCALE_MODEL","links":[100],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"UpscaleModelLoader"},"widgets_values":["epoch885_OmniSR.pth"]},{"id":81,"type":"VAEEncode","pos":[1600,325],"size":{"0":400,"1":50},"flags":{"collapsed":false},"order":56,"mode":0,"inputs":[{"name":"pixels","type":"IMAGE","link":548},{"name":"vae","type":"VAE","link":null}],"outputs":[{"name":"LATENT","type":"LATENT","links":[137],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"VAEEncode"}},{"id":94,"type":"ImpactKSamplerBasicPipe","pos":[1600,400],"size":{"0":400,"1":250},"flags":{},"order":57,"mode":0,"inputs":[{"name":"basic_pipe","type":"BASIC_PIPE","link":130,"slot_index":0},{"name":"latent_image","type":"LATENT","link":137}],"outputs":[{"name":"BASIC_PIPE","type":"BASIC_PIPE","links":[],"shape":3,"slot_index":0},{"name":"LATENT","type":"LATENT","links":[135],"shape":3,"slot_index":1},{"name":"VAE","type":"VAE","links":null,"shape":3}],"properties":{"Node name for S&R":"ImpactKSamplerBasicPipe"},"widgets_values":[0,"fixed",9,7,"dpmpp_2m","karras",0.45000000000000007],"color":"#322","bgcolor":"#533"},{"id":84,"type":"VAEDecode","pos":[1600,675],"size":{"0":400,"1":50},"flags":{"collapsed":false},"order":58,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":135},{"name":"vae","type":"VAE","link":null}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[121,132,133,138],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"VAEDecode"}},{"id":314,"type":"SEGSPaste","pos":[1100,725],"size":{"0":400,"1":125},"flags":{"collapsed":false},"order":52,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":508},{"name":"segs","type":"SEGS","link":500},{"name":"ref_image_opt","type":"IMAGE","link":null}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[505,547],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"SEGSPaste"},"widgets_values":[5,255],"color":"#223","bgcolor":"#335"},{"id":66,"type":"ImageUpscaleWithModel","pos":[1600,100],"size":{"0":400,"1":50},"flags":{},"order":54,"mode":4,"inputs":[{"name":"upscale_model","type":"UPSCALE_MODEL","link":100},{"name":"image","type":"IMAGE","link":547}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[555],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"ImageUpscaleWithModel"},"color":"#222","bgcolor":"#000"},{"id":339,"type":"ImageScale","pos":[1600,175],"size":{"0":400,"1":125},"flags":{},"order":55,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":555},{"name":"width","type":"INT","link":553,"widget":{"name":"width"}},{"name":"height","type":"INT","link":554,"widget":{"name":"height"}}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[548],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"ImageScale"},"widgets_values":["bilinear",512,512,"disabled"]},{"id":101,"type":"ADE_AnimateDiffUniformContextOptions","pos":[-1300,825],"size":{"0":400,"1":154},"flags":{},"order":6,"mode":0,"outputs":[{"name":"CONTEXT_OPTIONS","type":"CONTEXT_OPTIONS","links":[154],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"ADE_AnimateDiffUniformContextOptions"},"widgets_values":[16,1,0,"uniform",false]},{"id":71,"type":"ADE_AnimateDiffLoaderWithContext","pos":[-1300,1000],"size":{"0":400,"1":200},"flags":{},"order":30,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":531},{"name":"context_options","type":"CONTEXT_OPTIONS","link":154,"slot_index":1},{"name":"motion_lora","type":"MOTION_LORA","link":null},{"name":"motion_model_settings","type":"MOTION_MODEL_SETTINGS","link":null}],"outputs":[{"name":"MODEL","type":"MODEL","links":[485],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"ADE_AnimateDiffLoaderWithContext"},"widgets_values":["temporaldiff-v1-animatediff.safetensors","sqrt_linear (AnimateDiff)",1,false]},{"id":82,"type":"VAELoader","pos":[-1300,1225],"size":{"0":400,"1":75},"flags":{},"order":7,"mode":0,"outputs":[{"name":"VAE","type":"VAE","links":[118],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"VAELoader"},"widgets_values":["vae-ft-mse-840000-ema-pruned.safetensors"]},{"id":340,"type":"MathExpression|pysssss","pos":[-800,600],"size":{"0":400,"1":125},"flags":{"collapsed":false},"order":44,"mode":0,"inputs":[{"name":"a","type":"INT,FLOAT,IMAGE,LATENT","link":550},{"name":"b","type":"INT,FLOAT,IMAGE,LATENT","link":557},{"name":"c","type":"INT,FLOAT,IMAGE,LATENT","link":null}],"outputs":[{"name":"INT","type":"INT","links":[554],"shape":3,"slot_index":0},{"name":"FLOAT","type":"FLOAT","links":null,"shape":3}],"properties":{"Node name for S&R":"MathExpression|pysssss"},"widgets_values":["a.height*b"],"color":"#322","bgcolor":"#533"},{"id":45,"type":"SVD_img2vid_Conditioning","pos":[-1300,225],"size":{"0":400,"1":225},"flags":{},"order":35,"mode":0,"inputs":[{"name":"clip_vision","type":"CLIP_VISION","link":69},{"name":"init_image","type":"IMAGE","link":562,"slot_index":1},{"name":"vae","type":"VAE","link":71}],"outputs":[{"name":"positive","type":"CONDITIONING","links":[210],"shape":3,"slot_index":0},{"name":"negative","type":"CONDITIONING","links":[208],"shape":3,"slot_index":1},{"name":"latent","type":"LATENT","links":[66,549,550],"shape":3,"slot_index":2}],"properties":{"Node name for S&R":"SVD_img2vid_Conditioning"},"widgets_values":[1024,576,24,225,24,0.010000000000000002],"color":"#2a363b","bgcolor":"#3f5159"},{"id":49,"type":"VHS_VideoCombine","pos":[600,925],"size":[500,500],"flags":{},"order":49,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":73,"slot_index":0}],"outputs":[],"title":"SVD","properties":{"Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":8,"loop_count":0,"filename_prefix":"ComfyUI","format":"video/h264-mp4","pingpong":false,"save_image":true,"crf":20,"save_metadata":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"ComfyUI_09775.mp4","subfolder":"","type":"output","format":"video/h264-mp4"}}}},{"id":85,"type":"VHS_VideoCombine","pos":[1600,925],"size":[500,500],"flags":{},"order":59,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":121,"slot_index":0}],"outputs":[],"title":"Upscaled","properties":{"Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":8,"loop_count":0,"filename_prefix":"AnimateDiff","format":"video/h264-mp4","pingpong":false,"save_image":true,"crf":20,"save_metadata":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"AnimateDiff_01431.mp4","subfolder":"","type":"output","format":"video/h264-mp4"}}}},{"id":315,"type":"VHS_VideoCombine","pos":[1100,925],"size":[500,500],"flags":{},"order":53,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":505,"slot_index":0}],"outputs":[],"title":"1st Face Pass","properties":{"Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":8,"loop_count":0,"filename_prefix":"ComfyUI","format":"video/h264-mp4","pingpong":false,"save_image":true,"crf":20,"save_metadata":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"ComfyUI_09774.mp4","subfolder":"","type":"output","format":"video/h264-mp4"}}}},{"id":99,"type":"VHS_VideoCombine","pos":[2100,925],"size":[500,500],"flags":{},"order":63,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":134,"slot_index":0}],"outputs":[],"title":"2nd Face Pass","properties":{"Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":8,"loop_count":0,"filename_prefix":"AnimateDiff","format":"video/h264-mp4","pingpong":false,"save_image":true,"crf":20,"save_metadata":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"AnimateDiff_01432.mp4","subfolder":"","type":"output","format":"video/h264-mp4"}}}},{"id":79,"type":"smZ CLIPTextEncode","pos":[-300,225],"size":{"0":400,"1":175},"flags":{},"order":37,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":481,"slot_index":0}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[128],"shape":3,"slot_index":0}],"title":"Negative Prompt (Upscale)","properties":{"Node name for S&R":"smZ CLIPTextEncode"},"widgets_values":["embedding:ng_deepnegative_v1_75t, embedding:badhandv4, (worst quality:2), (low quality:2), (normal quality:2), lowres, watermark, (monochrome:1.4), fingers, blemish, scar,","A1111",true,true,false,false,6,1024,1024,0,0,1024,1024,"","",1],"color":"#322","bgcolor":"#533"},{"id":77,"type":"smZ CLIPTextEncode","pos":[-300,25],"size":{"0":400,"1":175},"flags":{},"order":38,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":482}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[127],"shape":3,"slot_index":0}],"title":"Positive Prompt (Upscale)","properties":{"Node name for S&R":"smZ CLIPTextEncode"},"widgets_values":["full body, beautiful face, smiling,","A1111",true,true,false,false,6,1024,1024,0,0,1024,1024,"","",1],"color":"#322","bgcolor":"#533"},{"id":97,"type":"smZ CLIPTextEncode","pos":[-300,425],"size":{"0":400,"1":175},"flags":{},"order":39,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":540}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[178],"shape":3,"slot_index":0}],"title":"Positive Prompt (Face)","properties":{"Node name for S&R":"smZ CLIPTextEncode"},"widgets_values":["eyeliner, eyeshadow, smiling, ","A1111",true,true,false,false,6,1024,1024,0,0,1024,1024,"","",1],"color":"#223","bgcolor":"#335"},{"id":98,"type":"smZ CLIPTextEncode","pos":[-300,625],"size":{"0":400,"1":175},"flags":{},"order":40,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":541,"slot_index":0}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[166],"shape":3,"slot_index":0}],"title":"Negative Prompt (Face)","properties":{"Node name for S&R":"smZ CLIPTextEncode"},"widgets_values":["(worst quality:2), (low quality:2), (normal quality:2), (strabismus:1.1), ","A1111",true,true,false,false,6,1024,1024,0,0,1024,1024,"","",1],"color":"#223","bgcolor":"#335"},{"id":115,"type":"ToBasicPipe","pos":[200,425],"size":{"0":300,"1":125},"flags":{},"order":46,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":542},{"name":"clip","type":"CLIP","link":559,"slot_index":1},{"name":"vae","type":"VAE","link":null},{"name":"positive","type":"CONDITIONING","link":178},{"name":"negative","type":"CONDITIONING","link":166}],"outputs":[{"name":"basic_pipe","type":"BASIC_PIPE","links":[168,501],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"ToBasicPipe"},"color":"#223","bgcolor":"#335"},{"id":91,"type":"ToBasicPipe","pos":[200,25],"size":{"0":300,"1":125},"flags":{},"order":45,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":483},{"name":"clip","type":"CLIP","link":493},{"name":"vae","type":"VAE","link":null,"slot_index":2},{"name":"positive","type":"CONDITIONING","link":127},{"name":"negative","type":"CONDITIONING","link":128}],"outputs":[{"name":"basic_pipe","type":"BASIC_PIPE","links":[130],"shape":3}],"properties":{"Node name for S&R":"ToBasicPipe"},"color":"#322","bgcolor":"#533"},{"id":44,"type":"VAEDecode","pos":[600,325],"size":{"0":400,"1":50},"flags":{},"order":48,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":67},{"name":"vae","type":"VAE","link":68}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[73,502,508,509],"slot_index":0}],"properties":{"Node name for S&R":"VAEDecode"}},{"id":338,"type":"MathExpression|pysssss","pos":[-800,450],"size":{"0":400,"1":125},"flags":{},"order":43,"mode":0,"inputs":[{"name":"a","type":"INT,FLOAT,IMAGE,LATENT","link":549},{"name":"b","type":"INT,FLOAT,IMAGE,LATENT","link":556,"slot_index":1},{"name":"c","type":"INT,FLOAT,IMAGE,LATENT","link":null}],"outputs":[{"name":"INT","type":"INT","links":[553],"shape":3,"slot_index":0},{"name":"FLOAT","type":"FLOAT","links":null,"shape":3}],"properties":{"Node name for S&R":"MathExpression|pysssss"},"widgets_values":["a.width*b"],"color":"#322","bgcolor":"#533"},{"id":143,"type":"ConditioningConcat","pos":[-800,200],"size":{"0":400,"1":50},"flags":{"collapsed":false},"order":41,"mode":0,"inputs":[{"name":"conditioning_to","type":"CONDITIONING","link":210},{"name":"conditioning_from","type":"CONDITIONING","link":209,"slot_index":1}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[211],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"ConditioningConcat"},"color":"#232","bgcolor":"#353"},{"id":142,"type":"ConditioningConcat","pos":[-800,375],"size":{"0":400,"1":50},"flags":{"collapsed":false},"order":42,"mode":0,"inputs":[{"name":"conditioning_to","type":"CONDITIONING","link":208},{"name":"conditioning_from","type":"CONDITIONING","link":206,"slot_index":1}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[207],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"ConditioningConcat"},"color":"#232","bgcolor":"#353"},{"id":318,"type":"Note","pos":[600,-275],"size":{"0":400,"1":175},"flags":{},"order":8,"mode":0,"properties":{"text":""},"widgets_values":["SVD Settings (2):\n\nSteps may be adjusted here. Higher is more stable, but lower can get some creative results."],"color":"#432","bgcolor":"#653"},{"id":328,"type":"Note","pos":[-1300,-275],"size":{"0":900,"1":175},"flags":{},"order":9,"mode":0,"properties":{"text":""},"widgets_values":["SVD Settings (1):\n\nYou can control SVD output by prompting in green box. You can try (zooming:2) or (panning:2).\n\nResults are not always guaranteed as the image conditioning is very strong, but I found that prompting helps the success rate.\n\nYou can bypass the green nodes if you find that these do not help.\n\nHigh fps helps for making moving camera shots. Lower fps can make body movements."],"color":"#432","bgcolor":"#653"},{"id":100,"type":"SEGSPaste","pos":[2100,725],"size":{"0":400,"1":125},"flags":{},"order":62,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":133},{"name":"segs","type":"SEGS","link":131},{"name":"ref_image_opt","type":"IMAGE","link":null}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[134,176,577],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"SEGSPaste"},"widgets_values":[5,255],"color":"#223","bgcolor":"#335"},{"id":357,"type":"RIFE VFI","pos":[3100,25],"size":{"0":400,"1":200},"flags":{},"order":65,"mode":0,"inputs":[{"name":"frames","type":"IMAGE","link":577,"slot_index":0},{"name":"optional_interpolation_states","type":"INTERPOLATION_STATES","link":null}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[578],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"RIFE VFI"},"widgets_values":["rife47.pth",10,3,true,true,1]},{"id":116,"type":"RIFE VFI","pos":[2600,25],"size":{"0":400,"1":200},"flags":{},"order":64,"mode":0,"inputs":[{"name":"frames","type":"IMAGE","link":176,"slot_index":0},{"name":"optional_interpolation_states","type":"INTERPOLATION_STATES","link":null}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[175,579],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"RIFE VFI"},"widgets_values":["rife47.pth",10,2,true,true,1]},{"id":324,"type":"Note","pos":[1600,-275],"size":{"0":400,"1":175},"flags":{},"order":10,"mode":0,"properties":{"text":""},"widgets_values":["Simple resize and AnimateDiff + Upscale pass:\n\nYou can try x4 GAN upscales or upscales of your choice.\n\nI personally prefer simply rescaling with bilinear setting so I have them bypassed by default. It is faster this way and also less likely to introduce flickering from my experience. \n\nUpscale resize/multiplier can be set on red node on the left.\n\nAll the sampler settings may be adjusted."],"color":"#432","bgcolor":"#653"},{"id":48,"type":"LoadImage","pos":[-2600,25],"size":{"0":600,"1":475},"flags":{},"order":11,"mode":0,"outputs":[{"name":"IMAGE","type":"IMAGE","links":[567],"shape":3,"slot_index":0},{"name":"MASK","type":"MASK","links":null,"shape":3,"slot_index":1}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["example.png","image"]},{"id":352,"type":"LoadImagesFromDir //Inspire","pos":[-2600,525],"size":{"0":600,"1":125},"flags":{},"order":29,"mode":2,"inputs":[{"name":"start_index","type":"INT","link":565,"widget":{"name":"start_index"},"slot_index":0}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[566],"shape":3,"slot_index":0},{"name":"MASK","type":"MASK","links":null,"shape":3},{"name":"INT","type":"INT","links":null,"shape":3}],"properties":{"Node name for S&R":"LoadImagesFromDir //Inspire"},"widgets_values":["",1,4]},{"id":354,"type":"PrimitiveNode","pos":[-2600,675],"size":{"0":200,"1":75},"flags":{},"order":12,"mode":2,"outputs":[{"name":"INT","type":"INT","links":[565],"slot_index":0,"widget":{"name":"start_index"}}],"properties":{},"widgets_values":[4,"increment"]},{"id":355,"type":"Reroute","pos":[-1900,175],"size":[75,26],"flags":{},"order":33,"mode":0,"inputs":[{"name":"","type":"*","link":566}],"outputs":[{"name":"","type":"IMAGE","links":null}],"properties":{"showOutputText":false,"horizontal":false}},{"id":353,"type":"Reroute","pos":[-1500,100],"size":[75,26],"flags":{},"order":32,"mode":0,"inputs":[{"name":"","type":"*","link":568}],"outputs":[{"name":"","type":"IMAGE","links":[562,563],"slot_index":0}],"properties":{"showOutputText":false,"horizontal":false}},{"id":345,"type":"Note","pos":[-1800,1025],"size":{"0":400,"1":275},"flags":{},"order":13,"mode":0,"properties":{"text":""},"widgets_values":["AnimateDiff settings:\n\nI normally use these settings. \n\nLowering Motion_scale might reduce flickering in eyes though the result is still uncertain."],"color":"#432","bgcolor":"#653"},{"id":307,"type":"LoraLoader|pysssss","pos":[-800,825],"size":{"0":400,"1":175},"flags":{},"order":34,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":485},{"name":"clip","type":"CLIP","link":486}],"outputs":[{"name":"MODEL","type":"MODEL","links":[483,542],"shape":3,"slot_index":0},{"name":"CLIP","type":"CLIP","links":[481,482,493,540,541,559],"shape":3,"slot_index":1}],"title":"Face Lora","properties":{"Node name for S&R":"LoraLoader|pysssss"},"widgets_values":[{"content":"#face\\JapaneseDollLikeness_v15.safetensors","image":null},0.5,0.5,"[none]"]},{"id":326,"type":"Note","pos":[2100,-275],"size":{"0":400,"1":175},"flags":{},"order":14,"mode":0,"properties":{"text":""},"widgets_values":["AnimateDiff + Face Detailer:\n\nBypass this column for closeups.\n\nI like to keep these settings for a natural result. \n\nAdjusting guide size/denoise/steps may be necessary. \n\n"],"color":"#432","bgcolor":"#653"},{"id":319,"type":"Note","pos":[1100,-275],"size":{"0":400,"1":175},"flags":{},"order":15,"mode":0,"properties":{"text":""},"widgets_values":["AnimateDiff + Face Detailer:\n\nBypass this column for closeups. Doing 2 Face Detailer passes instead of one is necessary for wide shots.\n\nAlthough I have not shown the workflow here, I found that Facerestore with GFPGANv1.4 is another option."],"color":"#432","bgcolor":"#653"},{"id":329,"type":"Note","pos":[2600,-275],"size":{"0":400,"1":175},"flags":{},"order":16,"mode":0,"properties":{"text":""},"widgets_values":["This is a frame interpolation node. \n\nAdjust the multiplier and frame rate according to your needs."],"color":"#432","bgcolor":"#653"},{"id":119,"type":"VHS_VideoCombine","pos":[2600,925],"size":[500,500],"flags":{},"order":66,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":175}],"outputs":[],"title":"Frame Interpolated","properties":{"Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":16,"loop_count":0,"filename_prefix":"_final16","format":"video/h264-mp4","pingpong":false,"save_image":true,"crf":0,"save_metadata":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"_final16_00001.mp4","subfolder":"","type":"output","format":"video/h264-mp4"}}}},{"id":358,"type":"VHS_VideoCombine","pos":[3100,925],"size":[500,500],"flags":{},"order":68,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":578}],"outputs":[],"title":"Frame Interpolated","properties":{"Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":24,"loop_count":0,"filename_prefix":"_final24","format":"video/h264-mp4","pingpong":false,"save_image":true,"crf":0,"save_metadata":true,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"_final24_00001.mp4","subfolder":"","type":"output","format":"video/h264-mp4"}}}},{"id":356,"type":"Reroute","pos":[-1900,25],"size":[75,26],"flags":{},"order":28,"mode":0,"inputs":[{"name":"","type":"*","link":567}],"outputs":[{"name":"","type":"IMAGE","links":[568],"slot_index":0}],"properties":{"showOutputText":false,"horizontal":false}},{"id":350,"type":"FloatConstant","pos":[-1300,475],"size":{"0":400,"1":75},"flags":{},"order":17,"mode":0,"outputs":[{"name":"value","type":"FLOAT","links":[556,557],"shape":3,"slot_index":0}],"title":"Upscale Multiplier","properties":{"Node name for S&R":"FloatConstant"},"widgets_values":[2],"color":"#322","bgcolor":"#533"},{"id":75,"type":"CheckpointLoaderSimpleWithNoiseSelect","pos":[-1300,625],"size":{"0":400,"1":125},"flags":{},"order":18,"mode":0,"outputs":[{"name":"MODEL","type":"MODEL","links":[531],"shape":3,"slot_index":0},{"name":"CLIP","type":"CLIP","links":[532],"shape":3,"slot_index":1},{"name":"VAE","type":"VAE","links":null,"shape":3}],"properties":{"Node name for S&R":"CheckpointLoaderSimpleWithNoiseSelect"},"widgets_values":["majicmixRealistic_v6.safetensors","sqrt_linear (AnimateDiff)"]},{"id":67,"type":"CLIPSetLastLayer","pos":[-1300,750],"size":{"0":400,"1":58},"flags":{},"order":31,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":532}],"outputs":[{"name":"CLIP","type":"CLIP","links":[486],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"CLIPSetLastLayer"},"widgets_values":[-2]},{"id":359,"type":"VHS_VideoCombine","pos":[2600,1450],"size":[500,500],"flags":{},"order":67,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":579}],"outputs":[],"title":"Frame Interpolated","properties":{"Node name for S&R":"VHS_VideoCombine"},"widgets_values":{"frame_rate":16,"loop_count":0,"filename_prefix":"AnimateDiff","format":"image/gif","pingpong":false,"save_image":true,"crf":0,"save_metadata":false,"videopreview":{"hidden":false,"paused":false,"params":{"filename":"AnimateDiff_01430.gif","subfolder":"","type":"output","format":"image/gif"}}}},{"id":361,"type":"Note","pos":[-1800,425],"size":{"0":400,"1":275},"flags":{},"order":19,"mode":0,"properties":{"text":""},"widgets_values":["Upscale multiplier is set here:\n\nBy default it is 1024 x 576 * 2 = 2048 x 1152\n\nCheckpoint can be set here:\n\nExperiment with different motion models."],"color":"#432","bgcolor":"#653"},{"id":344,"type":"Note","pos":[-300,-275],"size":{"0":400,"1":175},"flags":{},"order":20,"mode":0,"properties":{"text":""},"widgets_values":["Prompt Settings:\n\nA1111 style prompting is used as I am more familiar with the weighting.\n\nWith many 1.5 checkpoints, the negative prompt is extremely important to generate good render quality. Make sure yours is set correctly according to your checkpoint.\n\nPositive prompt is not as important. It is mainly there to trigger loras, or add additional prompts to describe the face (smiling closed eyes, eyeliner, makeup, lipstick)."],"color":"#432","bgcolor":"#653"},{"id":332,"type":"Note","pos":[-2600,-675],"size":{"0":1200,"1":575},"flags":{},"order":21,"mode":0,"properties":{"text":""},"widgets_values":["v1.0:\n\nThis is a SVD img2vid workflow designed to restore the face which is oftentimes destroyed in images where the subject is far away in the distance. It was made with photorealism in mind. \n\nIt can restore the facial features of the original image to some degree as you can use the original checkpoints and loras to upscale the SVD output with AnimateDiff. The results may vary as motion modules seem to impose their own bias. You will have to reweight your prompt and loras accordingly.\n\nIt can also be used for general purpose SVD video upscaling.\n\nSome Tips: \n\n- Bypass the blue columns for closeups. This workflow is not designed for closeup portraits as you do not need as many Face Detailer passes for closeups. Unnecessary passes may lead to uncanniness. This workflow can also be used to upscale scenic photos without any people or faces this way. \n\n- If possible, avoid images that show teeth. I found that AnimateDiff can sometimes add movement to the teeth. Side profile pictures can also look strange.\n\n- Lower frame count on SVD and upscale with lower value if the VRAM usage is too high.\n\nSome Findings:\n\n- Forcing SVD to generate at a higher resolution will still require upscaling and Face Detailing to fix the face and hands. Recommended resolution settings seem to work best. Vertical images (width/height swapped) also seem to work but with less success rate.\n\n- Upscaling with SVD seems to lack quality, and loses likeness of the face in the original image, but feel free to experiment!\n\n- AnimateDiff + Face detailing can sometimes add unnecessary flickering and movement to eyes face. I do not know how to minimize this at the moment. Reducing motion scale seems to help sometimes, but oftentimes I mess with lora and denoise settings and regenerate. I suspect that a finetuned motion module for faces may help solve this problem.\n\n- This workflow can also be changed in order to use SDXL + HotshotXL for upscaling and Face Detailing. From my limited findings, 1.5 checkpoints with temporaldiff/AnimateDiff provided more high quality results in the background, but HotshotXL provided a more natural face. \n\n- FreeU and LCM with Controlnet Tile are both compatible but photorealism is lost. It may work for other styles but I think some experimentation is necessary.\n\nModels:\n\nhttps://huggingface.co/CiaraRowles/TemporalDiff/tree/main\n\nhttps://huggingface.co/laion/CLIP-ViT-H-14-laion2B-s32B-b79K/blob/main/open_clip_pytorch_model.bin\n\nhttps://civitai.com/models/43331/majicmix-realistic"],"color":"#2a363b","bgcolor":"#3f5159"}],"links":[[66,45,2,43,3,"LATENT"],[67,43,0,44,0,"LATENT"],[68,47,2,44,1,"VAE"],[69,47,1,45,0,"CLIP_VISION"],[71,47,2,45,2,"VAE"],[73,44,0,49,0,"IMAGE"],[100,65,0,66,0,"UPSCALE_MODEL"],[118,82,0,83,0,"*"],[121,84,0,85,0,"IMAGE"],[123,87,0,86,1,"SEGS"],[127,77,0,91,3,"CONDITIONING"],[128,79,0,91,4,"CONDITIONING"],[130,91,0,94,0,"BASIC_PIPE"],[131,86,0,100,1,"SEGS"],[132,84,0,87,1,"IMAGE"],[133,84,0,100,0,"IMAGE"],[134,100,0,99,0,"IMAGE"],[135,94,1,84,0,"LATENT"],[137,81,0,94,1,"LATENT"],[138,84,0,86,0,"IMAGE"],[141,82,0,91,2,"VAE"],[142,82,0,81,1,"VAE"],[143,82,0,84,1,"VAE"],[154,101,0,71,1,"CONTEXT_OPTIONS"],[166,98,0,115,4,"CONDITIONING"],[168,115,0,86,2,"BASIC_PIPE"],[175,116,0,119,0,"IMAGE"],[176,100,0,116,0,"IMAGE"],[178,97,0,115,3,"CONDITIONING"],[188,82,0,81,1,"VAE"],[189,82,0,84,1,"VAE"],[190,82,0,91,2,"VAE"],[191,82,0,115,2,"VAE"],[204,139,0,136,0,"CLIP"],[206,140,0,142,1,"CONDITIONING"],[207,142,0,43,2,"CONDITIONING"],[208,45,1,142,0,"CONDITIONING"],[209,136,0,143,1,"CONDITIONING"],[210,45,0,143,0,"CONDITIONING"],[211,143,0,43,1,"CONDITIONING"],[212,139,0,140,0,"CLIP"],[246,82,0,84,1,"VAE"],[247,82,0,91,2,"VAE"],[248,82,0,115,2,"VAE"],[249,82,0,81,1,"VAE"],[464,262,0,233,4,"INT"],[465,262,0,265,4,"INT"],[466,262,0,245,4,"INT"],[467,262,0,165,4,"INT"],[468,262,0,296,4,"INT"],[481,307,1,79,0,"CLIP"],[482,307,1,77,0,"CLIP"],[483,307,0,91,0,"MODEL"],[485,71,0,307,0,"MODEL"],[486,67,0,307,1,"CLIP"],[493,307,1,91,1,"CLIP"],[497,311,0,310,1,"SEGS"],[500,310,0,314,1,"SEGS"],[501,115,0,310,2,"BASIC_PIPE"],[502,44,0,311,1,"IMAGE"],[505,314,0,315,0,"IMAGE"],[508,44,0,314,0,"IMAGE"],[509,44,0,310,0,"IMAGE"],[517,262,0,233,4,"INT"],[518,262,0,265,4,"INT"],[519,262,0,245,4,"INT"],[520,262,0,165,4,"INT"],[521,262,0,276,4,"INT"],[522,82,0,91,2,"VAE"],[523,82,0,115,2,"VAE"],[524,82,0,81,1,"VAE"],[525,82,0,84,1,"VAE"],[531,75,0,71,0,"MODEL"],[532,75,1,67,0,"CLIP"],[533,325,0,320,0,"*"],[534,323,0,321,0,"*"],[538,47,0,334,0,"MODEL"],[539,334,0,43,0,"MODEL"],[540,307,1,97,0,"CLIP"],[541,307,1,98,0,"CLIP"],[542,307,0,115,0,"MODEL"],[547,314,0,66,1,"IMAGE"],[548,339,0,81,0,"IMAGE"],[549,45,2,338,0,"INT,FLOAT,IMAGE,LATENT"],[550,45,2,340,0,"INT,FLOAT,IMAGE,LATENT"],[553,338,0,339,1,"INT"],[554,340,0,339,2,"INT"],[555,66,0,339,0,"IMAGE"],[556,350,0,338,1,"INT,FLOAT,IMAGE,LATENT"],[557,350,0,340,1,"INT,FLOAT,IMAGE,LATENT"],[559,307,1,115,1,"CLIP"],[562,353,0,45,1,"IMAGE"],[563,353,0,335,0,"IMAGE"],[565,354,0,352,0,"INT"],[566,352,0,355,0,"*"],[567,48,0,356,0,"*"],[568,356,0,353,0,"*"],[569,323,0,87,0,"BBOX_DETECTOR"],[570,325,0,87,2,"SAM_MODEL"],[571,323,0,311,0,"BBOX_DETECTOR"],[572,325,0,311,2,"SAM_MODEL"],[573,82,0,81,1,"VAE"],[574,82,0,84,1,"VAE"],[575,82,0,115,2,"VAE"],[576,82,0,91,2,"VAE"],[577,100,0,357,0,"IMAGE"],[578,357,0,358,0,"IMAGE"],[579,116,0,359,0,"IMAGE"],[580,323,0,87,0,"BBOX_DETECTOR"],[581,325,0,87,2,"SAM_MODEL"],[582,323,0,311,0,"BBOX_DETECTOR"],[583,325,0,311,2,"SAM_MODEL"],[584,82,0,81,1,"VAE"],[585,82,0,84,1,"VAE"],[586,82,0,115,2,"VAE"],[587,82,0,91,2,"VAE"]],"groups":[],"config":{},"extra":{},"version":0.4}